<div class="d-flex">
  <app-sidebar></app-sidebar>
  <main class="content">
    <div class="container mt-4" style="flex-grow: 1;">
      <!-- Navbar -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div class="input-group w-50">
          <span class="input-group-text">
            <i class="bi bi-search"></i>
          </span>
          <input type="text" class="form-control w-50" placeholder="Search tasks..." />
        </div>
        <div class="d-flex align-items-center ms-auto gap-2">
          <button class="btn btn-light mx-2">
            <i class="bi bi-bell"></i>
          </button>
          <button class="btn btn-light mx-2">
            <i class="bi bi-question-circle"></i>
          </button>
          <img src="assets/user_img.jpg" class="rounded-circle" width="15%" height="30%" alt="Profile" />
        </div>
      </div>

      <!-- Add Task Form (Toggle Button) -->
      <div class="d-flex justify-content-between align-items-center mb-3">
        <button class="btn btn-info me-2" (click)="filterTasks()">Search</button>
        <button class="btn btn-success mb-4" (click)="isAddTaskActive = !isAddTaskActive">
          {{ isAddTaskActive ? 'Close Form' : 'Add Task' }}
        </button>
      </div>

      <!-- Add Task Form -->
      <div *ngIf="isAddTaskActive" class="card p-3">
        <h4>Add New Task</h4>
        <div class="form-group mt-3">
          <label>Task Name</label>
          <input type="text" class="form-control" [value]="newTask.taskname" (input)="newTask.taskname = $event.target.value" />
        </div>
        <div class="form-group mt-3">
          <label>Description</label>
          <textarea class="form-control" [value]="newTask.description" (input)="newTask.description = $event.target.value"></textarea>
        </div>
        <div class="form-group mt-3">
          <label>Start Date</label>
          <input type="date" class="form-control" [value]="newTask.startDate" (input)="newTask.startDate = $event.target.value" />
        </div>
        <div class="form-group mt-3">
          <label>End Date</label>
          <input type="date" class="form-control" [value]="newTask.endDate" (input)="newTask.endDate = $event.target.value" />
        </div>
        <div class="form-group mt-3">
          <label>Task Status</label>
          <input type="text" class="form-control" [value]="newTask.taskstatus" (input)="newTask.taskstatus = $event.target.value" />
        </div>
        <div class="form-group mt-3">
          <label>Task Manager</label>
          <input type="text" class="form-control" [value]="newTask.managername" (input)="newTask.managername = $event.target.value" />
        </div>
        <div class="form-group mt-3">
          <label>Team Members</label>
          <input type="text" class="form-control" [value]="newTask.teammember" (input)="newTask.teammember = $event.target.value" />
        </div>
        <div class="form-group mt-3">
          <label>Client Name</label>
          <input type="text" class="form-control" [value]="newTask.clientname" (input)="newTask.clientname = $event.target.value" />
        </div>
        <div class="form-group mt-3">
          <label>Task Domain</label>
          <input type="text" class="form-control" [value]="newTask.domain" (input)="newTask.domain = $event.target.value" />
        </div>

        <button class="btn btn-success mt-4" (click)="addTask()">Add Task</button>
      </div>

      <!-- Tasks Table -->
      <div class="table-responsive mt-4">
        <table class="table table-bordered table-hover table-striped">
          <thead class="thead-light">
            <tr>
              <th>Sr</th>
              <th>Task Name</th>
              <th>Start Date</th>
              <th>Task Status</th>
              <th>Manager Name</th>
              <th>Team Members</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let task of tasks; let i = index">
              <td>{{ task.Sr }}</td>
              <td>{{ task.taskname }}</td>
              <td>{{ task.startDate }}</td>
              <td>{{ task.taskstatus }}</td>
              <td>{{ task.managername }}</td>
              <td>{{ task.teammember }}</td>
              <td>
                <button class="btn btn-sm btn-outline-info me-2" (click)="viewTask(i)">
                  <i class="bi bi-eye"></i>
                </button>
                <button class="btn btn-sm btn-outline-warning me-2" (click)="openUpdateForm(i)">
                  <i class="bi bi-pencil-square"></i>
                </button>
                <button class="btn btn-sm btn-outline-danger" (click)="deleteTask(i)">
                  <i class="bi bi-trash"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Task View Section -->
      <div *ngIf="isViewActive" class="card mt-4 p-3">
        <h4>View Task Details</h4>
        <p><strong>Task Name:</strong> {{ selectedTask.taskname }}</p>
        <p><strong>Description:</strong> {{ selectedTask.description }}</p>
        <p><strong>Start Date:</strong> {{ selectedTask.startDate }}</p>
        <p><strong>End Date:</strong> {{ selectedTask.endDate }}</p>
        <p><strong>Task Status:</strong> {{ selectedTask.taskstatus }}</p>
        <p><strong>Manager Name:</strong> {{ selectedTask.managername }}</p>
        <p><strong>Team Members:</strong> {{ selectedTask.teammember }}</p>
        <p><strong>Client Name:</strong> {{ selectedTask.clientname }}</p>
        <p><strong>Task Domain:</strong> {{ selectedTask.domain }}</p>

        <button class="btn btn-secondary mt-3" (click)="closeView()">Close</button>
      </div>

      <!-- Update Task Form -->
      <div *ngIf="isUpdateActive" class="card mt-4 p-3">
        <h4>Update Task Information</h4>
        <div class="form-group">
          <label>Task Name</label>
          <input type="text" class="form-control" [value]="editableTask.taskname" (input)="editableTask.taskname = $event.target.value" />
        </div>
        <div class="form-group mt-3">
          <label>Description</label>
          <textarea class="form-control" [value]="editableTask.description" (input)="editableTask.description = $event.target.value"></textarea>
        </div>
        <div class="form-group mt-3">
          <label>Start Date</label>
          <input type="date" class="form-control" [value]="editableTask.startDate" (input)="editableTask.startDate = $event.target.value" />
        </div>
        <div class="form-group mt-3">
          <label>End Date</label>
          <input type="date" class="form-control" [value]="editableTask.endDate" (input)="editableTask.endDate = $event.target.value" />
        </div>        
        <div class="form-group mt-3">
          <label>Task Status</label>
          <input type="text" class="form-control" [value]="editableTask.taskstatus" (input)="editableTask.taskstatus = $event.target.value" />
        </div>
        <div class="form-group mt-3">
          <label>Task Manager</label>
          <input type="text" class="form-control" [value]="editableTask.managername" (input)="editableTask.managername = $event.target.value" />
        </div>
        <div class="form-group mt-3">
          <label>Team Members</label>
          <input type="text" class="form-control" [value]="editableTask.teammember" (input)="editableTask.teammember = $event.target.value" />
        </div>
        <button class="btn btn-success mt-4" (click)="saveUpdate()">Save</button>
        <button class="btn btn-secondary mt-4" (click)="cancelUpdate()">Cancel</button>
      </div>
    </div>
  </main>
</div>
